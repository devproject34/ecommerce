{"version":3,"file":"getNextTickFunction.js","names":["getNextTickFunction","process","nextTick","f","canSetImmediate","window","setImmediate","canPost","postMessage","addEventListener","queue","ev","source","data","stopPropagation","length","fn","shift","push","setTimeout"],"sources":["../source/getNextTickFunction.js"],"sourcesContent":["// https://timnew.me/blog/2014/06/23/process-nexttick-implementation-in-browser/\r\nexport default function getNextTickFunction() {\r\n\t// In Node.js.\r\n\tif (typeof process !== 'undefined' && typeof process.nextTick === 'function') {\r\n\t\t// Calls the `callback` via `process.nextTick(callback, error)` to emulate \"asynchronous\" behavior.\r\n\t\t// https://nodejs.org/en/docs/guides/event-loop-timers-and-nexttick#why-use-processnexttick\r\n\t\treturn function(f) {\r\n\t\t\tprocess.nextTick(f)\r\n\t\t}\r\n\t}\r\n\r\n\tconst canSetImmediate = typeof window !== 'undefined' && window.setImmediate\r\n\tconst canPost = typeof window !== 'undefined' && window.postMessage && window.addEventListener\r\n\r\n\tif (canSetImmediate) {\r\n\t\treturn function(f) {\r\n\t\t\twindow.setImmediate(f)\r\n\t\t}\r\n\t}\r\n\r\n\tif (canPost) {\r\n\t\tconst queue = []\r\n\t\twindow.addEventListener('message', function(ev) {\r\n\t\t\tconst source = ev.source\r\n\t\t\tif ((source === window || source === null) && ev.data === 'process-tick') {\r\n\t\t\t\tev.stopPropagation()\r\n\t\t\t\tif (queue.length > 0) {\r\n\t\t\t\t\tconst fn = queue.shift()\r\n\t\t\t\t\tfn()\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}, true)\r\n\r\n\t\treturn function nextTick(fn) {\r\n\t\t\tqueue.push(fn)\r\n\t\t\twindow.postMessage('process-tick', '*')\r\n\t\t}\r\n\t}\r\n\r\n\treturn function nextTick(fn) {\r\n\t\tsetTimeout(fn, 0)\r\n\t}\r\n}"],"mappings":";;;;;;AAAA;AACe,SAASA,mBAAmBA,CAAA,EAAG;EAC7C;EACA,IAAI,OAAOC,OAAO,KAAK,WAAW,IAAI,OAAOA,OAAO,CAACC,QAAQ,KAAK,UAAU,EAAE;IAC7E;IACA;IACA,OAAO,UAASC,CAAC,EAAE;MAClBF,OAAO,CAACC,QAAQ,CAACC,CAAC,CAAC;IACpB,CAAC;EACF;EAEA,IAAMC,eAAe,GAAG,OAAOC,MAAM,KAAK,WAAW,IAAIA,MAAM,CAACC,YAAY;EAC5E,IAAMC,OAAO,GAAG,OAAOF,MAAM,KAAK,WAAW,IAAIA,MAAM,CAACG,WAAW,IAAIH,MAAM,CAACI,gBAAgB;EAE9F,IAAIL,eAAe,EAAE;IACpB,OAAO,UAASD,CAAC,EAAE;MAClBE,MAAM,CAACC,YAAY,CAACH,CAAC,CAAC;IACvB,CAAC;EACF;EAEA,IAAII,OAAO,EAAE;IACZ,IAAMG,KAAK,GAAG,EAAE;IAChBL,MAAM,CAACI,gBAAgB,CAAC,SAAS,EAAE,UAASE,EAAE,EAAE;MAC/C,IAAMC,MAAM,GAAGD,EAAE,CAACC,MAAM;MACxB,IAAI,CAACA,MAAM,KAAKP,MAAM,IAAIO,MAAM,KAAK,IAAI,KAAKD,EAAE,CAACE,IAAI,KAAK,cAAc,EAAE;QACzEF,EAAE,CAACG,eAAe,CAAC,CAAC;QACpB,IAAIJ,KAAK,CAACK,MAAM,GAAG,CAAC,EAAE;UACrB,IAAMC,EAAE,GAAGN,KAAK,CAACO,KAAK,CAAC,CAAC;UACxBD,EAAE,CAAC,CAAC;QACL;MACD;IACD,CAAC,EAAE,IAAI,CAAC;IAER,OAAO,SAASd,QAAQA,CAACc,EAAE,EAAE;MAC5BN,KAAK,CAACQ,IAAI,CAACF,EAAE,CAAC;MACdX,MAAM,CAACG,WAAW,CAAC,cAAc,EAAE,GAAG,CAAC;IACxC,CAAC;EACF;EAEA,OAAO,SAASN,QAAQA,CAACc,EAAE,EAAE;IAC5BG,UAAU,CAACH,EAAE,EAAE,CAAC,CAAC;EAClB,CAAC;AACF"}